homeassistant:
  name: !secret address
  unit_system: metric
  latitude: !secret home_latitude
  longitude: !secret home_longitude
  elevation: 102
  time_zone: Australia/Adelaide
  customize: !include_dir_merge_named configuration/customize/
  whitelist_external_dirs:
  - '/tmp'
#  packages: !include_dir_named packages

zone:
  - name: Home
    latitude: !secret home_latitude
    longitude: !secret home_longitude
    radius: 50

  - name: Mawson Lakes
    latitude: !secret mlk_latitude
    longitude: !secret mlk_longitude
    radius: 500

logger:
  default: warn
  logs:
    homeassistant.components.command_line.switch: fatal
    haffmpeg.tools: error
    

######################################################################################################
###------------------------------------------ YAML FILES ------------------------------------------###
######################################################################################################
automation: !include_dir_merge_list configuration/automation/
group: !include_dir_merge_named configuration/group/
script: !include configuration/scripts.yaml

######################################################################################################
###------------------------------------------ CORE STUFF ------------------------------------------###
######################################################################################################

config:

conversation:

discovery:
  ignore:
  - yeelight

frontend:
  javascript_version: latest
  themes: !include configuration/themes.yaml
  extra_html_url:
    - /local/custom_ui/state-card-tiles.html
    - /local/custom_ui/custom-weather-card.html
  extra_html_url_es5:
    - /local/custom_ui/state-card-tiles_es5.html
    - /local/custom_ui/custom-weather-card.html

history:

http:
#  api_password: !secret api_password
#  trusted_networks:
  ip_ban_enabled: true
  login_attempts_threshold: 3
  use_x_forwarded_for: true
  trusted_proxies:
  - 127.0.0.1
  base_url: !secret dns_name
#  ssl_certificate: !secret ssl_cert
#  ssl_key: !secret ssl_key

influxdb:
  host: 10.1.0.7

logbook:
  exclude:
    entities:
    - light_controller.last_message
    - automation.battery_sensor_from_battery_level_attribute
    - automation.battery_sensor_from_battery_attribute
    - automation.battery_notification_clear
    - automation.battery_notification
    - automation.update_battery_status_group_members
#    - automation.lights_set_lifx_brightness
#    - automation.lights_set_lifx_colour_temp
    - sensor.time
    - sensor.time_date
    - sensor.time_utc
    domains:
    - group

lovelace:
  mode: yaml

map:

mqtt:
  broker: 10.1.0.8
  port: 1883
  username: !secret mqtt_username
  password: !secret mqtt_password
#  discovery: true
#  discovery_prefix: homeassistant

notify:
  - platform: html5
    name: html5
    vapid_pub_key: !secret vapid_pub_key
    vapid_prv_key: !secret vapid_prv_key
    vapid_email: !secret vapid_email


person:

updater:
  include_used_components: true

recorder:
  purge_interval: 2
  purge_keep_days: 14

shopping_list:

sun:

system_health:

######################################################################################################
###------------------------------------------ COMPONENTS ------------------------------------------###
######################################################################################################
custom_updater:
  show_installable: false
  track:
    - components
    - cards
    - python_scripts
  card_urls: 
    - https://raw.githubusercontent.com/kalkih/mini-media-player/master/tracker.json
    - https://raw.githubusercontent.com/iammexx/home-assistant-config/master/ui/darksky/version.json

ifttt:
  key: !secret ifttt_key

ffmpeg:
  ffmpeg_bin: /usr/bin/ffmpeg

panel_iframe:
  unifi:
    title: UniFi
    url: !secret dns_unifi
    icon: mdi:router-wireless
  sonarr:
    title: Sonarr
    url: !secret dns_sonarr
    icon: mdi:television-classic
  radarr:
    title: Radarr
    url: !secret dns_radarr
    icon: mdi:filmstrip
  plex:
    title: Plex
    url: !secret dns_plex
    icon: mdi:plex

######################################################################################################
###------------------------------------------ PLATFORMS -------------------------------------------###
######################################################################################################

alexa:
  smart_home:
    filter:
      include_entities:
      - light.bedroom
      - light.wardrobe
      - light.ensuite
      - light.study
      - light.kitchen
      - light.living_room
      - light.lounge
      - light.front_door
      - light.laundry
      - light.back_door
      - light.carport
      - light.outside_front
      - light.verandah
      - switch.heater_living_room_power
      - switch.triplej
      - switch.sprinkler_control
      - switch.heater_living_room_power
      - switch.vacuum
      - switch.airplay_shed
      - switch.airplay_appletv
      - switch.airplay_bedroom
      - group.lights
    entity_config:
      switch.heater_living_room_power:
        name: Living Room Heater
        description: The heater in the living room
        display_categories: SMARTPLUG
      switch.triplej:
        name: Triple J
        description: Triple J on the radio
        display_categories: SPEAKER
      switch.vacuum:
        name: Vacuum Cleaner
        display_categories: SMARTPLUG
      switch.sprinkler_control:
        name: Sprinklers
        display_categories: SWITCH
      switch.airplay_shed:
        name: Shed AirPlay
        display_categories: SPEAKER
      switch.airplay_appletv:
        name: Living Room AirPlay
        display_categories: SPEAKER
      switch.airplay_bedroom:
        name: Bedroom AirPlay
        display_categories: SPEAKER
      group.lights:
        name: All Lights
        display_categories: LIGHT

#disabled the next 3 lines 2/4/19
#daikin:
#  hosts:
#    - 10.10.3.163

#  monitored_conditions:
#    - inside_temperature
#    - outside_temperature

google_assistant:
  project_id: home-assistant-144414
#  client_id: !secret google_client_id
#  access_token: !secret google_access_token
  api_key: !secret google_homegraph_api_key
  exposed_domains:
    - switch
    - light
    - group

homekit:
  auto_start: false
  ip_address: 10.1.0.3
  filter:
    include_entities:
      - light.bedroom
      - light.wardrobe
      - light.ensuite
      - light.study
      - light.kitchen
      - light.living_room
      - light.lounge
      - light.front_door
      - light.laundry
      - light.back_door
      - light.pool_room
      - light.carport
      - light.outside_front
      - light.verandah
      - switch.sprinkler_control
      - input_boolean.homekit_location
      - media_player.living_room
      - media_player.bedroom
      - switch.heater_living_room_power
      - switch.vacuum
      - switch.triplej
      - switch.airplay_shed
      - switch.airplay_living_room
      - switch.airplay_bedroom
      - switch.lights
      - cover.roller_door
      - fan.verandah
      - climate.ac_bedroom
  entity_config:
    media_player.living_room:
      feature_list:
        - feature: on_off
    media_player.bedroom:
      feature_list:
        - feature: on_off
    switch.heater_living_room_power:
      name: Living Room Heater
    switch.vacuum:
      name: Vacuum Cleaner
    switch.triplej:
      name: Triple J
    switch.airplay_shed:
      name: Shed AirPlay
    switch.airplay_living_room:
      name: Living Room AirPlay
    switch.airplay_bedroom:
      name: Bedroom AirPlay
    switch.sprinkler_control:
      name: Sprinklers
      type: sprinkler

xiaomi_aqara:
  discovery_retry: 5
  gateways:
    - mac: !secret xiaomi_aqara_mac
      key: !secret xiaomi_aqara_key
      host: 10.10.3.10

######################################################################################################
###------------------------------------------ DEVICES ---------------------------------------------###
######################################################################################################

#climate:
#  - platform: daikin
#    name: ac_bedroom
#    host: 10.10.3.163

camera:
  - platform: ffmpeg
    input: -rtsp_transport tcp -i rtsp://10.10.2.149/unicast
    name: Carport
    extra_arguments: -pred 1 -q:v 2

  - platform: ffmpeg
    input: -rtsp_transport tcp -i rtsp://10.10.3.148:8554/unicast
    name: Front Yard
    extra_arguments: -pred 1 -q:v 2

#  - platform: generic
#    still_image_url: http://www.bom.gov.au/radar/IDR643.gif?{{ now().strftime("%Y%m%d%H%M") }}00
#    name: bom_rain_radar
#    limit_refetch_to_url_change: true

cover:
  - platform: mqtt
    name: "Roller Door"
    state_topic: "node/cover/008/state"
    command_topic: "node/cover/008/command"
    payload_open: "OPEN"
    payload_close: "CLOSE"
    payload_stop: "STOP"
    state_open: "open"
    state_closed: "close"
    availability_topic: "node/cover/008/availability"
    payload_available: "online"
    payload_not_available: "offline"

fan:
  - platform: xiaomi_miio
    host: 10.10.2.164
    token: !secret xiaomi_miio_token_airpurifier

  - platform: mqtt
    name: "Verandah"
    command_topic: "node/003/command"
    state_topic: "node/003/state"
    speed_command_topic: "node/003/command"
    availability_topic: "node/003/availability"
    payload_on: "fan_on"
    payload_off: "fan_off"
    payload_low_speed: "fan_low"
    payload_medium_speed: "fan_medium"
    payload_high_speed: "fan_high"
    speeds:
      - low
      - medium
      - high

light:
#  - platform: lifx

  - platform: mqtt
    name: Carport
    unique_id: light_mqtt_carport
    command_topic: cmnd/sonoff/carport-lights/POWER
    payload_on: 'ON'
    payload_off: 'OFF'
    state_topic: stat/sonoff/carport-lights/POWER1

  - platform: mqtt
    name: Flux
    command_topic: "light/flux/command"
    color_temp_command_topic: "light/flux/color_temp"
    rgb_command_topic: "light/flux/color_rgb"

#  - platform: xiaomi_miio
#    name: Kitchen Sink
#    host: 10.10.1.143
#    token: !secret xiaomi_miio_token_light
#    model: philips.light.bulb


  - platform: group
    name: Outside Front
    entities:
      - light.front_west
      - light.front_east

  - platform: group
    name: Kitchen
    entities:
      - light.kitchen_main
      - light.kitchen_1
      - light.kitchen_2
      - light.kitchen_3

  - platform: group
    name: Pool Room
    entities:
      - light.pool_room_north
      - light.pool_room_south

  - platform: mqtt
    name: Verandah
    command_topic: "node/003/command"
    state_topic: "node/003/state"
    availability_topic: "node/003/availability"
    payload_on: "light_on"
    payload_off: "light_off"

#light_controller:
#  topic: node/light_switch/

yeelight:
  devices:
    10.10.1.141:
      name: Front West
    10.10.1.142:
      name: Front East

plant:
  peace_lily:
    sensors:
      moisture: sensor.plant_1_moisture
#      battery: sensor.plant_1_battery
      temperature: sensor.plant_1_temperature
      conductivity: sensor.plant_1_conductivity
      brightness: sensor.plant_1_brightness
    min_moisture: 15
    max_moisture: 65

device_tracker:
#  - platform: icloud
#    username: !secret icloud_username
#    password: !secret icloud_password
#    track_new_devices: no

  - platform: unifi
    host: 10.1.0.154
    username: !secret unifi_username
    password: !secret unifi_password
    detection_time: 5
    verify_ssl: False
    new_device_defaults:
      track_new_devices: False
      hide_if_away: False

speedtestdotnet:
  monitored_conditions:
    - ping
    - download
    - upload

vacuum:
  - platform: xiaomi_miio
    host: 10.10.3.140
    token: !secret xiaomi_miio_token_vacuum

weather:
# RISK OF TOO MANY API CALLS - check combined calls with the Dark Sky Sensor
  - platform: darksky
    api_key: !secret darksky_api_key
    mode: daily
    scan_interval:
      minutes: 5

  - platform: bom
    station: 'IDS60901.95677'


######################################################################################################
###--------------------------------------------- MEDIA --------------------------------------------###
######################################################################################################
apple_tv:
  - host: 10.2.0.17
    login_id: !secret apple_tv_id
    credentials: !secret apple_tv_credentials

media_extractor:

cast:
  media_player:
  - host: 10.10.3.123

media_player:
  - platform: mpd
    host: 10.1.0.5
#    port: 3689

  - platform: plex
    entity_namespace: 'plex'
    use_custom_entity_ids: true
  
  - platform: universal
    name: Living Room TV
    children:
      - media_player.living_room_apple_tv
    commands:
      turn_on:
        service: script.living_room_tv_on
      turn_off:
        service: script.living_room_tv_off
      volume_up:
        service: switch.turn_on
        data:
          entity_id: switch.living_room_audio_volume
      volume_down:
        service: switch.turn_off
        data:
          entity_id: switch.living_room_audio_volume
      volume_mute:
        service: switch.turn_on
        data:
          entity_id: switch.living_room_audio_mute
    attributes:
      # is_volume_muted: ENTITY_ID|ATTRIBUTE
      state: binary_sensor.living_room_tv_power_status

  - platform: universal
    name: Bedroom TV
    children:
    - media_player.bedroom_chromecast
    commands:
      turn_on:
        service: media_player.turn_on
        data:
          entity_id: media_player.bedroom_chromecast
      turn_off:
        service: media_player.turn_off
        data:
          entity_id: media_player.bedroom_chromecast
      volume_up:
        service: media_player.volume_up
        data:
          entity_id: media_player.bedroom_chromecast
      volume_down:
        service: media_player.volume_down
        data:
          entity_id: media_player.bedroom_chromecast



######################################################################################################
###----------------------------------------- NOTIFICATIONS ----------------------------------------###
######################################################################################################

ios:
  push:
    categories:
      - name: Roller Door
        identifier: 'roller_door_alert'
        actions:
          - identifier: 'ROLLER_DOOR_CLOSE'
            title: 'Close'
            activationMode: 'background'
            authenticationRequired: yes
            destructive: yes
            behavior: 'default'
          - identifier: 'IGNORE'
            title: 'Ignore'
            activationMode: 'background'
            authenticationRequired: yes
            destructive: no

      - name: Roller Door Camera Test
        identifier: 'camera'
        actions:
          - identifier: 'ROLLER_DOOR_CLOSE'
            title: 'Close'
            activationMode: 'background'
            authenticationRequired: yes
            destructive: yes
            behavior: 'default'
          - identifier: 'IGNORE'
            title: 'Ignore'
            activationMode: 'background'
            authenticationRequired: yes
            destructive: no

      - name: Roller Door
        identifier: 'roller_door_prompt'
        actions:
          - identifier: 'ROLLER_DOOR_OPEN'
            title: 'Open'
            activationMode: 'background'
            authenticationRequired: yes
            destructive: yes
          - identifier: 'IGNORE'
            title: 'Ignore'
            activationMode: 'background'
            authenticationRequired: no
            destructive: no

      - name: Door Bell
        identifier: 'door_bell_alert'
        actions:
          - identifier: 'IGNORE'
            title: 'Ignore'
            activationMode: 'background'
            authenticationRequired: no
            destructive: no
            
      - name: Sprinkler Alert
        identifier: 'sprinkler_alert'
        actions:
          - identifier: 'SPRINKLERS_OFF'
            title: 'Turn Off'
            activationMode: 'background'
            authenticationRequired: no
            destructive: no
          - identifier: 'IGNORE'
            title: 'Ignore'
            activationMode: 'background'
            authenticationRequired: no
            destructive: yes

      - name: Washing Machine Alert
        identifier: 'washing_machine_alert'
        actions:
          - identifier: 'IGNORE'
            title: 'Ignore'
            activationMode: 'background'
            authenticationRequired: no
            destructive: yes

      - name: Dishwasher Alert
        identifier: 'dishwasher_alert'
        actions:
          - identifier: 'IGNORE'
            title: 'Ignore'
            activationMode: 'background'
            authenticationRequired: no
            destructive: yes

      - name: Lights Alert
        identifier: 'lights_alert'
        actions:
          - identifier: 'IGNORE'
            title: 'Ignore'
            activationMode: 'background'
            authenticationRequired: no
            destructive: yes

######################################################################################################
###-------------------------------------------- TIMERS --------------------------------------------###
######################################################################################################
timer:
  sprinkler_zone_1:
  sprinkler_zone_2:
  sprinkler_zone_3:
  sprinkler_zone_4:
  
  sleep_bedroom:


######################################################################################################
###------------------------------------------- SWITCHES -------------------------------------------###
######################################################################################################
switch:
  - platform: broadlink
    host: 10.10.2.135
    mac: 'B4:43:0D:F9:1F:3A'
    switches:
      living_room_tv_power:
        friendly_name: "Living Room TV Power"
        command_on: 'JgAOAYKDEEIPQhBDEEIPIw8hEEIRIQ9DDyIPQw8iDyIPIw4iECIPQhFBECIQQg8iD0MQIg9CDwABKoKDEEIPRA5DD0MPIg8iEEIQIg9DDyIQQhAhDyIQIg4iECIPQw9CESEPQxAhD0MQIQ9DEAABKYGEEEIPQw9DEEIQIQ8iEEIQIRBCECIQQhAhECEPIg8iDyMPQhBCECIPQhAiEEIQIQ9DEAABKYGEEEIPQxBCD0MPIg8iD0MQIQ9DDyIQQhAhECIPIg8iDyIPQw9DECEPQw8iEEIPIhBCEAABKYKEEEIQQg9CEEIQIg8iD0MQIRBCECEQQg8iECEQIREhECEQQhBCECEPQxAhEEIQIRBCEAANBQAAAAAAAAAAAAA='
        command_off: 'JgAOAYKDEEIPQhBDEEIPIw8hEEIRIQ9DDyIPQw8iDyIPIw4iECIPQhFBECIQQg8iD0MQIg9CDwABKoKDEEIPRA5DD0MPIg8iEEIQIg9DDyIQQhAhDyIQIg4iECIPQw9CESEPQxAhD0MQIQ9DEAABKYGEEEIPQw9DEEIQIQ8iEEIQIRBCECIQQhAhECEPIg8iDyMPQhBCECIPQhAiEEIQIQ9DEAABKYGEEEIPQxBCD0MPIg8iD0MQIQ9DDyIQQhAhECIPIg8iDyIPQw9DECEPQw8iEEIPIhBCEAABKYKEEEIQQg9CEEIQIg8iD0MQIRBCECEQQg8iECEQIREhECEQQhBCECEPQxAhEEIQIRBCEAANBQAAAAAAAAAAAAA='
      living_room_audio_power:
        friendly_name: "Living Room Audio Power"
        command_on: 'JgBQAAABJpUUEhETEhMSOBITERURExITETkSOBI4FBERORE5EjgRORMSERQRFBEUEzcRFBETFBIROBI5ETgRORITETkUNhI4EQAFIgABJkwTAA0FAAAAAAAAAAA='
        command_off: 'JgBQAAABJpUUEhETEhMSOBITERURExITETkSOBI4FBERORE5EjgRORMSERQRFBEUEzcRFBETFBIROBI5ETgRORITETkUNhI4EQAFIgABJkwTAA0FAAAAAAAAAAA='
      living_room_audio_source:
        friendly_name: "Living Room Audio Source"
        # on = TV/optical
        command_on: 'JgBQAAABJ5YRFBETEhQROBITEhQRExITEjgSOBI4ERQSOBE5EjgRORE5EjgRFBI4ERMSFBEUERMSFBEUETgSFBE4EjgSORE4EQAFIgABJ0sRAA0FAAAAAAAAAAA=' 
        # off = MusicPi/3.5mm
        command_off: 'JgBYAAABKJQSExEVERMSOBITEhMRFBITEjgSOBE5EhMRORI4ETkROBIUETgSFBE4EhMSFBETEhMSOBITETkSExE5EjgSOBE5EgAFIQABJ0sRAAxaAAEnSxMADQU='
      living_room_audio_volume:
        friendly_name: "Living Room Audio Volume"
        # on = volume up
        command_on: 'JgBQAAABKZMTEhQRExITNxMSExEVERMSEzYTNxQ3ExEUNxM2EzcUNhQRFDYUERQ2FDYTEhQRFBETNhUREzYVERMSEzYUNhQ3EwAFHwABKUkUAA0FAAAAAAAAAAA='
        # off = volume down
        command_off: 'JgBQAAABKZMTEhQRFBETNxQRExITEhQREzYVNhM2FBITNhM3FDcTNhMTEzYTNxQ2FBEUERMSFBEUNhQRFBETEhM3EzYVNhM3EwAFHwABKUkUAA0FAAAAAAAAAAA='
      living_room_audio_mute:
        friendly_name: "Living Room Audio Mute"
        command_on: 'JgBQAAABKZIVERMSExEVNhMRFBETExMRFDcTNhM3FBETNxQ2FDYTNxQREzcUNhMSFDYTERURExITNxMSExEUNxMRFDcTNhM3FAAFHwABKUkTAA0FAAAAAAAAAAA='
        command_off: 'JgBQAAABKZIVERMSExEVNhMRFBETExMRFDcTNhM3FBETNxQ2FDYTNxQREzcUNhMSFDYTERURExITNxMSExEUNxMRFDcTNhM3FAAFHwABKUkTAA0FAAAAAAAAAAA='
      
      heater_living_room_power:
        friendly_name: "Living Room Heater Power"
        command_on: 'JgBIAAABKJUTExE5ERQRFBITEhQRFBE5EhMRORM4EhMRFBE5EjgTExEUETkSExEUETkSFBEUETkROREUEjkROREUETkSOREUEQANBQ=='
        command_off: 'JgBIAAABKJYRFBE5EhQRFBEUERQRFBE5EhQRORE5ERQRFBI5ETkRFBE5ERQSORE5ERQRFBEUETkSFBE5ERQRFBE5EjkROREUEQANBQ=='
      heater_living_room_temp:
        friendly_name: "Living Room Heater Temp"
        # on = up
        command_on: 'JgBIAAABKJYRFBE5ERQRFBEUEhQRFBE5ERQRORE6ERQRFBE5EjgRFBI5ERQSExE5ERQRFREUETkRFBE5EToRFBE5ETkRORIUEQANBQ=='
        # off = down
        command_off: 'JgBIAAABKZQSFBE5EhMRFBEUEhMSFBE5EhMRORI4ExMSExI4ETkRFBIUETkROREUEhMSExIUETkSOBEUEhMSORE5ETkSOBIUEgANBQ=='

  - platform: broadlink
    host: 10.10.2.136
    mac: '34:EA:34:42:BA:9F'
    switches:
      bedroom_tv_power:
        friendly_name: "Bedroom TV Power"
        command_on: 'JgBmAAo7ChoJGgkaCRoJGgk8CTwJGgo7CRoKGQkaCTwKGggABewKPAkaCRkKGgkaCTwJGgkZCjwJGgk8CTwKOwkbCTwJAAWnCTwKGQkbCRkKGQkbCTsKPAkZCjwJGgkaCRoJPAoZCQANBQAA='
        command_off: 'JgBmAAo7ChoJGgkaCRoJGgk8CTwJGgo7CRoKGQkaCTwKGggABewKPAkaCRkKGgkaCTwJGgkZCjwJGgk8CTwKOwkbCTwJAAWnCTwKGQkbCRkKGQkbCTsKPAkZCjwJGgkaCRoJPAoZCQANBQAA='

  - platform: command_line
    switches:
      triplej:
        friendly_name: Triple J
        command_on:
          curl "http://server-music.local:3689/login?request-session-id=50";
          curl "http://server-music.local:3689/ctrl-int/1/playspec?database-spec='dmap.persistentid:0x1'&container-spec='dmap.persistentid:0x1'&container-item-spec='dmap.containeritemid:0x7'&session-id=50";
          curl "http://server-music.local:3689/logout?session-id=50"
        command_off:
          curl "http://server-music.local:3689/login?request-session-id=50";
          curl "http://server-music.local:3689/ctrl-int/1/pause?session-id=50";
          curl "http://server-music.local:3689/logout?session-id=50"
        command_state: "/usr/bin/mpc -h server-music.local current"
        value_template: '{{ value == "Triple J NSW - Triple J NSW" }}'

      airplay_shed:
        friendly_name: Shed AirPlay
        command_on: "/usr/bin/mpc -h server-music.local enable 19358"
        command_off: "/usr/bin/mpc -h server-music.local disable 19358"
        command_state: "/usr/bin/mpc -h server-music.local outputs | grep 19358"
        value_template: '{{ value == "Output 19358 (MusicPi-Shed) is enabled" }}'

      airplay_living_room:
        friendly_name: Living Room AirPlay
        command_on: "/usr/bin/mpc -h server-music.local enable 51348"
        command_off: "/usr/bin/mpc -h server-music.local disable 51348"
        command_state: "/usr/bin/mpc -h server-music.local outputs | grep 51348"
        value_template: '{{ value == "Output 51348 (MusicPi) is enabled" }}'
      
      airplay_appletv:
        friendly_name: Apple TV AirPlay
        command_on: "/usr/bin/mpc -h server-music.local enable 30673"
        command_off: "/usr/bin/mpc -h server-music.local disable 30673"
        command_state: "/usr/bin/mpc -h server-music.local outputs | grep 30673"
        value_template: '{{ value == "Output 30673 (Living Room) is enabled" }}'
      
      airplay_bedroom:
        friendly_name: Bedroom AirPlay
        command_on: "/usr/bin/mpc -h server-music.local enable 43023"
        command_off: "/usr/bin/mpc -h server-music.local disable 43023"
        command_state: "/usr/bin/mpc -h server-music.local outputs | grep 43023"
        value_template: '{{ value == "Output 43023 (Bedroom HomePod) is enabled" }}'
      
      airplay_sonos:
        friendly_name: Sonos AirPlay
        command_on: "/usr/bin/mpc -h server-music.local enable 53"
        command_off: "/usr/bin/mpc -h server-music.local disable 53"
        command_state: "/usr/bin/mpc -h server-music.local outputs | grep 53"
        value_template: '{{ value == "Output 53 (Living Room Sono) is enabled" }}'
      

  - platform: mqtt
    name: Sprinkler Zone 1
    icon: mdi:water
    state_topic: "node/sprinkler/006/state"
    command_topic: "node/sprinkler/006/command"
    availability_topic: "node/sprinkler/006/availability"
    payload_on: "1_on"
    payload_off: "1_off"

  - platform: mqtt
    name: Sprinkler Zone 2
    icon: mdi:water
    state_topic: "node/sprinkler/006/state"
    command_topic: "node/sprinkler/006/command"
    availability_topic: "node/sprinkler/006/availability"
    payload_on: "2_on"
    payload_off: "2_off"

  - platform: mqtt
    name: Sprinkler Zone 3
    icon: mdi:water
    state_topic: "node/sprinkler/006/state"
    command_topic: "node/sprinkler/006/command"
    availability_topic: "node/sprinkler/006/availability"
    payload_on: "3_on"
    payload_off: "3_off"

  - platform: mqtt
    name: Sprinkler Zone 4
    icon: mdi:water
    state_topic: "node/sprinkler/006/state"
    command_topic: "node/sprinkler/006/command"
    availability_topic: "node/sprinkler/006/availability"
    payload_on: "4_on"
    payload_off: "4_off"

  - platform: mqtt
    name: Sprinkler Zone 5
    icon: mdi:water
    state_topic: "node/sprinkler/006/state"
    command_topic: "node/sprinkler/006/command"
    availability_topic: "node/sprinkler/006/availability"
    payload_on: "5_on"
    payload_off: "5_off"

  - platform: mqtt
    name: Sprinkler Zone 6
    icon: mdi:water
    state_topic: "node/sprinkler/006/state"
    command_topic: "node/sprinkler/006/command"
    availability_topic: "node/sprinkler/006/availability"
    payload_on: "6_on"
    payload_off: "6_off"

  - platform: mqtt
    name: Sprinkler Zone 7
    icon: mdi:water
    state_topic: "node/sprinkler/006/state"
    command_topic: "node/sprinkler/006/command"
    availability_topic: "node/sprinkler/006/availability"
    payload_on: "7_on"
    payload_off: "7_off"

  - platform: mqtt
    name: Sprinkler Zone 8
    icon: mdi:water
    state_topic: "node/sprinkler/006/state"
    command_topic: "node/sprinkler/006/command"
    availability_topic: "node/sprinkler/006/availability"
    payload_on: "8_on"
    payload_off: "8_off"

  - platform: mqtt
    name: "Dafang Left Right"
    command_topic: "topic/dafang/set"
    payload_off: "motor_left"
    payload_on: "motor_right"
    optimistic: false

#### SPRINKLERS
  - platform: template
    switches:
      sprinkler_control:
        friendly_name: Sprinkler Control
        value_template: "{{ is_state('input_boolean.sprinkler_control', 'on') }}"
        turn_on:
          service: homeassistant.turn_on
          data:
            entity_id: input_boolean.sprinkler_control
        turn_off:
          service: homeassistant.turn_off
          data:
            entity_id: input_boolean.sprinkler_control

      sprinkler_timer_1:
        friendly_name: Sprinkler Zone 1 Timer
        value_template: "{{ is_state('timer.sprinkler_zone_1', 'active') }}"
        turn_on:
          service: timer.start
          data_template:
            entity_id: timer.sprinkler_zone_1
            duration: '00:{{states.input_number.sprinkler_timer_1.state | int}}:00'
        turn_off:
          service: timer.finish
          data:
            entity_id: timer.sprinkler_zone_1

      sprinkler_timer_2:
        friendly_name: Sprinkler Zone 2 Timer
        value_template: "{{ is_state('timer.sprinkler_zone_2', 'active') }}"
        turn_on:
          service: timer.start
          data_template:
            entity_id: timer.sprinkler_zone_2
            duration: '00:{{states.input_number.sprinkler_timer_2.state | int}}:00'
        turn_off:
          service: timer.finish
          data:
            entity_id: timer.sprinkler_zone_2

      sprinkler_timer_3:
        friendly_name: Sprinkler Zone 3 Timer
        value_template: "{{ is_state('timer.sprinkler_zone_3', 'active') }}"
        turn_on:
          service: timer.start
          data_template:
            entity_id: timer.sprinkler_zone_3
            duration: '00:{{states.input_number.sprinkler_timer_3.state | int}}:00'
        turn_off:
          service: timer.finish
          data:
            entity_id: timer.sprinkler_zone_3

      sprinkler_timer_4:
        friendly_name: Sprinkler Zone 4 Timer
        value_template: "{{ is_state('timer.sprinkler_zone_4', 'active') }}"
        turn_on:
          service: timer.start
          data_template:
            entity_id: timer.sprinkler_zone_4
            duration: '00:{{states.input_number.sprinkler_timer_4.state | int}}:00'
        turn_off:
          service: timer.finish
          data:
            entity_id: timer.sprinkler_zone_4

  - platform: template
    switches:
      vacuum:
        friendly_name: Vacuum Cleaner
        entity_id: vacuum.xiaomi_vacuum_cleaner
        value_template: "{{ is_state('vacuum.xiaomi_vacuum_cleaner', 'cleaning') }}"
        turn_on:
          service: vacuum.start
          data:
            entity_id: vacuum.xiaomi_vacuum_cleaner
        turn_off:
          service: vacuum.return_to_base
          data:
            entity_id: vacuum.xiaomi_vacuum_cleaner


      ac_bedroom:
        friendly_name: Bedroom AC
        entity_id: climate.ac_bedroom
        value_template: "{{ is_state('climate.ac_bedroom', 'Auto') }}"
        turn_on:
          service: climate.set_operation_mode
          data:
            entity_id: climate.ac_bedroom
            operation_mode: 'Auto'
        turn_off:
          service: climate.set_operation_mode
          data:
            entity_id: climate.ac_bedroom
            operation_mode: 'Off'

      lights:
        friendly_name: "All Lights"
        value_template: "{{ is_state('group.lights', 'on') }}"
        turn_on:
          service: homeassistant.turn_on
          data:
            entity_id: group.lights
        turn_off:
          service: homeassistant.turn_off
          data:
            entity_id: group.lights

  - platform: flux
    lights:
      - light.flux
#      - light.outside_front
#      - light.kitchen_sink
#      - light.yeelight_rgb_7811dca21337
#      - light.yeelight_rgb_34ce008ce68b
#      - light.yeelight_rgb_34ce009133a2
    name: Flux
    start_time: '6:00'
    stop_time: '22:00'
    start_colortemp: 6500
    sunset_colortemp: 4500
    stop_colortemp: 2500
    disable_brightness_adjust: True
    mode: mired
    transition: 30
    interval: 30


######################################################################################################
###----------------------------------------- SHELL COMMANDS ---------------------------------------###
######################################################################################################

shell_command:
  forked_daapd_volume_bedroom: curl -X PUT "http://server-music.local:3689/api/player/volume?volume={{ states.input_number.forked_daapd_volume_bedroom.state | int }}&output_id=233717572806670"
  forked_daapd_volume_living_room: curl -X PUT "http://server-music.local:3689/api/player/volume?volume={{ states.input_number.forked_daapd_volume_living_room.state | int }}&output_id=203920983312531"
  forked_daapd_volume_shed: curl -X PUT "http://server-music.local:3689/api/player/volume?volume={{ states.input_number.forked_daapd_volume_shed.state | int }}&output_id=82372667526045"


######################################################################################################
###-------------------------------------------- INPUTS --------------------------------------------###
######################################################################################################

input_select:
  washing_machine_status:
    name: Washing Machine Status
    options:
      - Idle
      - Running
      - Finishing
      - Clean
    initial: Idle

  dishwasher_status:
    name: Dishwasher Status
    options:
      - Idle
      - Running
      - Finishing
      - Clean
    initial: Idle

  room_tracker:
    name: Last Room
    options:
      - Study
      - Laundry
      - Bedroom
      - Living Room
#      - Lounge
#      - Kitchen
#      - Front Door
      - Carport

  tablet_panel_detail:
    name: Active Tablet Detail Panel
    options:
      - Lights
      - Lights Advanced
      - Media
      - Cameras
      - Sprinklers
      - Sprinklers Advanced
      - Air Conditioner
      - Washer
      - Dishwasher
      - Alarm Clock
      - Vacuum Cleaner
      - Shed
      - Weather
      - Motion
      - Temperature
      - Appliances
      - Rooms
      - All

  tablet_panel_detail_appliances:
    name: Active Tablet Detail Appliances Panel
    options:
      - Washing Machine
      - Dishwasher
      - Vacuum Cleaner
      
  tablet_panel_detail_rooms:
    name: Active Tablet Detail Rooms Panel
    options:
      - Bedroom
      - Study

input_number: 
  alarmclock_hour:
     name: Hour
     icon: mdi:timer
     min: 4
     max: 12
     step: 1
     mode: slider
  alarmclock_minutes:
     name: Minutes
     icon: mdi:timer
     min: 0
     max: 55
     step: 5
     mode: slider

  sprinkler_timer_1:
    name: Back Lawn Top Sprinklers Timer
    icon: mdi:timer
    min: 0
    max: 120
    step: 5
    mode: slider
    unit_of_measurement: 'min'

  sprinkler_timer_2:
    name: Back Lawn Bottom Sprinklers Timer
    icon: mdi:timer
    min: 0
    max: 120
    step: 5
    mode: slider
    unit_of_measurement: 'min'

  sprinkler_timer_3:
    name: Back Garden Drippers Timer
    icon: mdi:timer
    min: 0
    max: 120
    step: 5
    mode: slider
    unit_of_measurement: 'min'

  sprinkler_timer_4:
    name: Front Lawn Sprinklers Timer
    icon: mdi:timer
    min: 0
    max: 120
    step: 5
    mode: slider
    unit_of_measurement: 'min'

  sprinkler_temp:
    name: Sprinkler Trigger Temp
    icon: mdi:thermometer
    unit_of_measurement: °C
    min: 10
    max: 40
    step: 1
    mode: slider

  dynamic_light_brightness:
    name: Dynamic Light Brightness
    icon: mdi:lightbulb-on
    unit_of_measurement: '%'
    min: 1
    max: 100
    mode: slider

  light_temp:
    name: Light Temperature
    icon: mdi:lightbulb-on
    unit_of_measurement: 'K'
    min: 2000
    max: 9000
    step: 100
    mode: slider

  living_room_volume_target:
    name: Living Room Volume Target
    min: 0
    max: 40
    step: 1
    
  living_room_volume_current:
    name: Living Room Volume
    min: 0
    max: 40
    step: 1

  forked_daapd_volume_bedroom:
    name: Bedroom Volume
    min: 0
    max: 100
    step: 1
    unit_of_measurement: '%'
    icon: mdi:volume-high

  forked_daapd_volume_living_room:
    name: Living Room Volume
    min: 0
    max: 100
    step: 1
    unit_of_measurement: '%'
    icon: mdi:volume-high

  forked_daapd_volume_shed:
    name: Shed Volume
    min: 0
    max: 100
    step: 1
    unit_of_measurement: '%'
    icon: mdi:volume-high

input_boolean:
  alarmclock_status:
    name: Alarm
    initial: on
    icon: mdi:alarm-check

  alarmclock_workday:
    name: Workdays Only
    initial: on
    icon: mdi:calendar

  light_check:
    name: Light Check
    icon: mdi:lightbulb-on
    initial: off

  holiday_mode_christmas:
    name: Christmas Holiday Mode
    icon: mdi:pine-tree

  homekit_control:
    name: Homekit Control
    initial: off

  motion_control:
    name: Motion Control
    icon: mdi:run
    initial: on

  sprinkler_control:
    name: Sprinkler Control
    icon: mdi:flower
    initial: off

  homekit_location:
    name: Homekit Location
    icon: mdi:account
  
#should be redundant with Lovelace
  tile_media:
  tile_room_bedroom:
  tile_room_study:
  tile_room_living_room:
  tile_main_lights:
  tile_alarm_clock:
  tile_home:
  tile_bedroom_ac:
  tile_tablet_buttons:
  tile_tablet_detail:
  tile_tablet_status:
  tile_tablet_date:
  tile_weather:
  tile_tablet_dummy:

# some of these could be dropped with Lovelace
  tile_tablet_button_large:
  tile_tablet_button_lights:
  tile_tablet_button_lights_advanced:
  tile_tablet_button_media:
  tile_tablet_button_cameras:
  tile_tablet_button_sprinklers:
  tile_tablet_button_sprinklers_advanced:
  tile_tablet_button_ac:
  tile_tablet_button_washer:
  tile_tablet_button_dishwasher:
  tile_tablet_button_alarm_clock:
  tile_tablet_button_vacuum_cleaner:
  tile_tablet_button_shed:
  tile_tablet_button_weather:
  tile_tablet_button_motion:
  tile_tablet_button_appliances:
  tile_tablet_button_appliances_washing_machine:
  tile_tablet_button_appliances_dishwasher:
  tile_tablet_button_appliances_vacuum_cleaner:
  tile_tablet_button_temperature:
  tile_tablet_button_rooms:
  
# should be redundant with Lovelace
  tile_tablet_panel_lights:
  tile_tablet_panel_lights_advanced:
  tile_tablet_panel_media:
  tile_tablet_panel_cameras:
  tile_tablet_panel_sprinklers:
  tile_tablet_panel_sprinklers_advanced:
  tile_tablet_panel_washer:
  tile_tablet_panel_dishwasher:
  tile_tablet_panel_alarm_clock:
  tile_tablet_panel_vacuum_cleaner:
  tile_tablet_panel_shed:
  tile_tablet_panel_weather:
  tile_tablet_panel_motion:
  tile_tablet_panel_rooms:
  
  tile_tablet_panel_rooms_bedroom:
  tile_tablet_panel_rooms_study:
  
  room_tracker_bedroom:
  room_tracker_living_room:
  room_tracker_study:
  room_tracker_laundry:
  

######################################################################################################
###----------------------------------------- BINARY SENSORS ---------------------------------------###
######################################################################################################
binary_sensor:
  - platform: workday
    country: AU
    province: SA
    workdays: [ mon, tue, wed, thu, fri ]

  - platform: workday
    name: Workday Tomorrow
    country: AU
    province: SA
    workdays: [ mon, tue, wed, thu, fri ]
    days_offset: 1

  - platform: mqtt
    name: Living Room TV Power Status
    state_topic: "node/power/004"
    payload_on: "on"
    payload_off: "off"
    device_class: power

  - platform: template
    sensors:
      alarmclock_tomorrow:
        friendly_name: "Alarm Clock Tomorrow"
        value_template: >-
          {% if is_state('input_boolean.alarmclock_status', 'off') %}
            False
          {% elif is_state('input_boolean.alarmclock_workday', 'on') and is_state('binary_sensor.workday_tomorrow', 'on') %}
            True
          {% elif is_state('input_boolean.alarmclock_workday', 'off') %}
            True
          {% else %}
            False
          {% endif %} 
             

######################################################################################################
###-------------------------------------------- SENSORS -------------------------------------------###
######################################################################################################
sensor:
#  - platform: google_travel_time
#    name: travel_city
#    api_key: !secret google_api_key
#    origin: zone.home
#    destination: !secret city_address
#    options:
#      mode: driving

#  - platform: google_travel_time
#    name: travel_work
#    api_key: !secret google_api_key
#    origin: zone.home
#    destination: !secret work_address
#    options:
#      mode: driving

#  - platform: google_travel_time
#    name: travel_home
#    api_key: !secret google_api_key
#    origin: device_tracker.daniel_iphone
#    destination: zone.home
#    options:
#      mode: driving

  - platform: pi_hole
    host: 10.1.0.4
    monitored_conditions:
    - ads_blocked_today
    - ads_percentage_today
    - queries_forwarded
    - dns_queries_today
  
  - platform: plex
    host: server.local

  - platform: plex_recently_added
    token: BcF1HJ7SQp5xsn6VqhmJ
#    host: server.local
    host: 10.1.0.10
    port: 32400
#    ssl: true
#    ssl_cert: false
#    download_images: false
    
  - platform: min_max
    name: Temperature Inside Average
    round_digits: 1
    type: mean
    entity_ids:
      - sensor.temperature_bedroom
      - sensor.temperature_ensuite
      - sensor.temperature_study
      - sensor.temperature_living_room
  

  - platform: openhardwaremonitor
    host: server.local


  - platform: bom_forecast
#    product_id: IDS10034
#    name: Parafield
#    forecast_days: 6
#    rest_of_today: true
    mode: separate
#    friendly_state_format: '{summary}'
    monitored_conditions:
      - 'max'
      - 'min'
      - 'chance_of_rain'
      - 'possible_rainfall'
      - 'summary'
      - 'detailed_summary'
#    text_if_no_value: '-'


  - platform: darksky
    api_key: !secret darksky_api_key
    forecast:
      - 0
      - 1
      - 2
      - 3
      - 4
      - 5
    monitored_conditions:
      - summary
      - precip_intensity
      - precip_probability
      - temperature
      - cloud_cover
      - humidity
      - temperature_high
      - temperature_low
      - minutely_summary
      - hourly_summary
      - daily_summary
# weather card_urls
      - icon
      - nearest_storm_distance
      - nearest_storm_bearing
      - apparent_temperature
      - apparent_temperature_high
      - apparent_temperature_low
      - wind_speed
      - wind_bearing
      - precip_type
      - precip_accumulation
      - precip_intensity_max
      - uv_index
      - pressure
      - visibility
    scan_interval:
      minutes: 5

#  - platform: wunderground
#    api_key: !secret wunderground_api_key
#    monitored_conditions:
#    - alerts
#    - precip_today_metric
#    - precip_1d_mm
#    - precip_1d
#    - precip_2d_mm
#    - precip_2d
#    - precip_3d_mm
#    - precip_3d
#    - relative_humidity
#    - temp_c
#    - temp_high_1d_c
#    - temp_low_1d_c
#    - temp_high_2d_c
#    - temp_low_2d_c
#    - wind_gust_kph
#    - wind_gust_1d_kph
#    - wind_kph
#    - wind_1d_kph
#    - weather
#    - weather_1d_metric
#    - weather_1n_metric

  - platform: template
    sensors:
      alarmclock_time:
        friendly_name: 'Alarm Clock Time'
        value_template: '{{ "%0.02d:%0.02d" | format(states("input_number.alarmclock_hour") | int, states("input_number.alarmclock_minutes") | int) }}'    
      
      washing_machine_power:
        friendly_name: Washing Machine Power Draw
        unit_of_measurement: 'watts'
        value_template: "{{ states.switch.plug_washing_machine.attributes.load_power }}"

      dishwasher_power:
        friendly_name: Dishwasher Power Draw
        unit_of_measurement: 'watts'
        value_template: "{{ states.switch.plug_dishwasher.attributes.load_power }}"

      bedroom_tv_power:
        friendly_name: Bedroom TV Power Draw
        unit_of_measurement: 'watts'
        value_template: "{{ states.switch.plug_bedroom_tv.attributes.load_power }}"

      bom_temperature:
        friendly_name: BOM Parafield Temperature
        unit_of_measurement: '°C'
        icon_template: mdi:thermometer
        value_template: "{{ states.weather.bom_parafield.attributes.temperature }}"

  - platform: template
    sensors:
      friendly_date:
        friendly_name: Current Date
        value_template: "{{ now().strftime('%-d %B') }}"
        entity_id: sensor.date

      friendly_time:
        friendly_name: Current Time
        value_template: "{{ now().strftime('%-I:%M %p') }}"
        entity_id: sensor.time

#####################
      sprinkler_zone_1_time_remaining:
        friendly_name: Sprinkler Zone 1 Time Remaining
        value_template: >-
          {%- if states.timer.sprinkler_zone_1.attributes.duration == "active" -%}
            {% set time =  (as_timestamp(states.timer.sprinkler_zone_1.last_changed) + as_timestamp(strptime(states.timer.sprinkler_zone_1.attributes.duration,"%H:%M:%S")) + 2208988800  - as_timestamp(now()) ) %} 
            {%- if time < 0 -%}
              {{ ( as_timestamp(states.timer.sprinkler_zone_1.last_changed) + as_timestamp(strptime(states.timer.sprinkler_zone_1.attributes.duration,"%H:%M:%S")) + 2208988800 - as_timestamp(now()) ) | timestamp_custom("%M:%S") }}
            {%- else -%}
              {{ ( as_timestamp(strptime(states.timer.sprinkler_zone_1.attributes.duration,"%H:%M:%S")) + 2208988800 ) | timestamp_custom("%M:%S") }} This one should be fixed
            {%- endif -%}
          {%- else -%}
            {{ (states.input_number.sprinkler_timer_1.state | int) }}:00
          {%- endif -%}
        entity_id: sensor.time
#####################

  - platform: template
    sensors:
      light_flux_color_temp:
        friendly_name: Light Flux Colour Temp
        value_template: >-
          {%- if states.light.flux.state == "on" -%}
            {{ 1000000 / states.light.flux.attributes.color_temp | int }}
          {%- else -%}
            {{ states.input_number.light_temp.state }}
          {%- endif -%}


  - platform: bom
    zone_id: !secret bom_zone_id
    wmo_id: !secret bom_wmo_id
    monitored_conditions:
    - rain_trace
    - wind_spd_kmh

  - platform: time_date
    display_options:
      - 'time'
      - 'date'
      - 'date_time'
      - 'time_date'
      - 'time_utc'
      - 'beat'

  - platform: sonarr
    api_key: !secret sonarr_api_key
    host: server.local
    monitored_conditions:
    - series
    - upcoming
    - queue
    - diskspace
    days: 3
    urlbase: /sonarr
    include_paths:
      - M:\
    
  - platform: radarr
    api_key: !secret radarr_api_key
    host: server.local
    monitored_conditions:
    - movies
    - upcoming
#    - diskspace
    days: 3
    urlbase: /radarr
#    include_paths:
#      - C:\

  - platform: template
    sensors:
      location_daniel:
        value_template: >-
            {% if is_state('input_boolean.homekit_location', 'on') %}
                Home
            {% else %}
                Away
            {% endif %}
        friendly_name: Daniel

  - platform: template
    sensors:
      washing_machine_status:
        value_template: '{{ states.input_select.washing_machine_status.state}}'
        friendly_name: 'Washing Machine'

      dishwasher_status:
        value_template: '{{ states.input_select.dishwasher_status.state}}'
        friendly_name: 'Dishwasher'
      
      sprinkler_status:
        value_template: '{{ states.group.irrigation.state}}'
        entity_id: group.irrigation
        friendly_name: 'Sprinklers'
        icon_template: mdi:water

  - platform: mqtt
    name: /plant_1_moisture
    state_topic: /plant/plant_1/
    value_template: '{{ value_json.moisture }}'
    unit_of_measurement: '%'
  - platform: mqtt
    name: plant_1_battery
    state_topic: /plant/plant_1/
    value_template: '{{ value_json.battery }}'
  - platform: mqtt
    name: plant_1_temperature
    state_topic: /plant/plant_1/
    value_template: '{{ value_json.temperature }}'
    unit_of_measurement: '°C'
  - platform: mqtt
    name: plant_1_conductivity
    state_topic: /plant/plant_1/
    value_template: '{{ value_json.conductivity }}'
    unit_of_measurement: 'μS/cm'
  - platform: mqtt
    name: plant_1_brightness
    state_topic: /plant/plant_1/
    value_template: '{{ value_json.brightness }}'
    unit_of_measurement: 'lux'

  - platform: rest
    name: Home Assistant Release
    resource: https://api.github.com/repos/home-assistant/home-assistant/releases
    username: !secret github_username
    password: !secret github_access_token
    authentication: basic
    value_template: '{{ value_json[0].tag_name }}'
    headers:
      Accept: application/vnd.github.v3+json
      Content-Type: application/json
      User-Agent: Home Assistant REST sensor

  - platform: rest
    name: Volume Master
    resource: http://10.1.0.5:3689/api/player
    value_template: '{{ value_json.volume }}'

  - platform: rest
    name: Forked Daapd Volume Bedroom
    resource: http://10.1.0.5:3689/api/outputs
    value_template: "{{ value_json.outputs | selectattr('name', 'equalto', 'Bedroom') | map(attribute='volume') | first }}"
    scan_interval: 5

#  - platform: rest
#    name: Forked Daapd Volume Living Room
#    resource: http://10.1.0.5:3689/api/outputs
#    value_template: "{{ value_json.outputs | selectattr('name', 'equalto', 'Living Room') | map(attribute='volume') | first }}"

  - platform: rest
    name: Forked Daapd Volume Living Room
    resource: http://10.1.0.5:3689/api/outputs
    value_template: "{{ value_json.outputs | selectattr('name', 'equalto', 'MusicPi') | map(attribute='volume') | first }}"
    scan_interval: 5

  - platform: rest
    name: Forked Daapd Volume Shed
    resource: http://10.1.0.5:3689/api/outputs
    value_template: "{{ value_json.outputs | selectattr('name', 'equalto', 'MusicPi-Shed') | map(attribute='volume') | first }}"
    scan_interval: 5
    

#  - platform: template
#    sensors:
#      volume_living_room:
#        value_template: '{{ states.sensor.forked_daapd_outputs.attributes[1].volume }}'
#        friendly_name: TV Living Source


  - platform: version

#  - platform: unifigateway
#    host: 10.1.0.154
#    username: !secret unifi_gateway_username
#    password: !secret unifi_password
#    monitored_conditions:
#      - www
#      - wan
#      - lan
#      - wlan
#      - alerts
#      - firmware

######################################################################################################
###--------------------------------------------- OTHER --------------------------------------------###
######################################################################################################

